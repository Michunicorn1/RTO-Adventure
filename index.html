<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>RTO Adventure 2026</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: 'Segoe UI', Arial, sans-serif;
  background: linear-gradient(#87CEEB, #E0F6FF);
  overflow: hidden;
}

canvas {
  display: block;
}

#ui {
  position: absolute;
  top: 15px;
  left: 15px;
  background: rgba(0,0,0,0.65);
  color: white;
  padding: 15px;
  border-radius: 15px;
  font-weight: bold;
}

#timer {
  position: absolute;
  top: 15px;
  right: 15px;
  background: #e53935;
  color: white;
  padding: 15px;
  border-radius: 15px;
  font-size: 22px;
  font-weight: bold;
}

#overlay {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.6);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10;
}

#card {
  background: white;
  padding: 35px;
  border-radius: 25px;
  text-align: center;
  max-width: 600px;
}

button {
  margin-top: 20px;
  padding: 15px 30px;
  border-radius: 25px;
  border: none;
  font-size: 18px;
  background: #4CAF50;
  color: white;
  cursor: pointer;
}
</style>
</head>

<body>

<div id="ui">
  ğŸ¢ Progreso: <span id="progress">0</span>%<br>
  â˜• EnergÃ­a: <span id="lives">3</span><br>
  ğŸ‘” Rol: <span id="role"></span><br>
  ğŸ‘¤ Protagonista: <span id="char"></span>
</div>

<div id="timer">
  â° <span id="time">60</span>s
</div>

<div id="overlay">
  <div id="card">
    <h1>ğŸ¢ RTO ADVENTURE 2026</h1>
    <p>Llega a la oficina antes de que empiece la reuniÃ³n.</p>
    <p><b>Managers:</b> 2 veces al mes<br>
       <b>Team:</b> 1 vez al mes</p>
    <p>â† â†’ mover | â†‘ saltar</p>
    <button id="start">Â¡Ir a la oficina!</button>
  </div>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

/* =========================
   RANDOM ROLE + CHARACTER
========================= */
const protagonists = [
  { role:"MANAGER", label:"ğŸ‘©â€ğŸ’¼" },
  { role:"MANAGER", label:"ğŸ‘¨â€ğŸ’¼" },
  { role:"EQUIPO", label:"ğŸ‘©â€ğŸ’»" },
  { role:"EQUIPO", label:"ğŸ‘¨â€ğŸ’»" }
];

const hero = protagonists[Math.floor(Math.random()*protagonists.length)];
document.getElementById("role").textContent = hero.role;
document.getElementById("char").textContent = hero.label;

const isManager = hero.role === "MANAGER";

/* =========================
   GAME STATE
========================= */
const game = {
  started:false,
  distance:0,
  target:isManager ? 1400 : 1200,
  lives:3,
  time:isManager ? 55 : 65
};

/* =========================
   PLAYER
========================= */
const player = {
  x:120,
  y:canvas.height-140,
  vy:0,
  w:40,
  h:50,
  onGround:false
};

/* =========================
   INPUT
========================= */
const keys = {};
addEventListener("keydown",e=>keys[e.key]=true);
addEventListener("keyup",e=>keys[e.key]=false);

/* =========================
   CLOUDS
========================= */
const clouds = Array.from({length:6},()=>({
  x:Math.random()*canvas.width,
  y:50+Math.random()*150,
  s:0.3+Math.random()*0.5
}));

/* =========================
   OBSTACLES
========================= */
const obstacles = [];
function spawnObstacle(){
  obstacles.push({
    x:canvas.width+50,
    y:canvas.height-110,
    w:40
  });
}
setInterval(()=>{ if(game.started) spawnObstacle(); }, isManager?1800:2300);

/* =========================
   TIMER
========================= */
setInterval(()=>{
  if(game.started){
    game.time--;
    document.getElementById("time").textContent = game.time;
    if(game.time<=0) end(false);
  }
},1000);

/* =========================
   MAIN LOOP
========================= */
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Sky
  ctx.fillStyle="#87CEEB";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // Clouds
  ctx.font="50px serif";
  clouds.forEach(c=>{
    ctx.fillText("â˜ï¸",c.x,c.y);
    c.x+=c.s;
    if(c.x>canvas.width+50) c.x=-50;
  });

  // Ground
  ctx.fillStyle="#555";
  ctx.fillRect(0,canvas.height-80,canvas.width,80);

  if(game.started){
    // World movement (KEY FIX)
    game.distance += isManager ? 2.6 : 2.2;

    // Player movement
    if(keys["ArrowLeft"]) player.x-=6;
    if(keys["ArrowRight"]) player.x+=6;
    if(keys["ArrowUp"] && player.onGround){
      player.vy=-15;
      player.onGround=false;
    }

    // Gravity
    player.vy+=0.7;
    player.y+=player.vy;

    if(player.y>=canvas.height-130){
      player.y=canvas.height-130;
      player.vy=0;
      player.onGround=true;
    }

    // Draw player
    ctx.font="40px serif";
    ctx.fillText(hero.label,player.x,player.y);

    // Obstacles
    obstacles.forEach(o=>{
      o.x-=5;
      ctx.fillText("ğŸš—",o.x,o.y);
      if(
        player.x<o.x+30 &&
        player.x+30>o.x &&
        player.y<o.y+30 &&
        player.y+30>o.y
      ){
        game.lives--;
        o.x=-100;
        if(game.lives<=0) end(false);
      }
    });

    // Office
    if(game.distance>=game.target){
      ctx.font="80px serif";
      ctx.fillText("ğŸ¢",canvas.width-150,canvas.height-150);
      if(player.x>canvas.width-180) end(true);
    }

    // UI
    document.getElementById("progress").textContent =
      Math.min(100,Math.floor(game.distance/game.target*100));
    document.getElementById("lives").textContent = game.lives;
  }

  requestAnimationFrame(loop);
}

/* =========================
   END GAME
========================= */
function end(win){
  game.started=false;
  document.getElementById("overlay").style.display="flex";
  document.getElementById("card").innerHTML = win
    ? "<h1>ğŸ‰ Llegaste a tiempo</h1><p>Excelente dÃ­a de RTO ğŸ’™</p><button onclick='location.reload()'>Jugar otra vez</button>"
    : "<h1>ğŸ˜… Llegaste tarde</h1><p>IntÃ©ntalo de nuevo</p><button onclick='location.reload()'>Reintentar</button>";
}

/* =========================
   START
========================= */
document.getElementById("start").onclick=()=>{
  game.started=true;
  document.getElementById("overlay").style.display="none";
};

loop();
</script>
</body>
</html>
